import CodeBlock from "@theme/CodeBlock";

# Lesson 2: Start Trip Form Inputs

This lesson focuses on building the first step of the trip logging form, the "Start Trip" page. We'll use components from the U.S. Web Design System (USWDS) library (`@trussworks/react-uswds`) to add inputs for the trip date, start time, and weather conditions.

## Step 1: Add Date Picker Input

We need a way for the user to select the date of their fishing trip. We'll use the `DatePicker` component from `@trussworks/react-uswds`.

### 1.1: Import the DatePicker Component

First, open `src/pages/StartTrip.jsx` and update the import statement from `@trussworks/react-uswds` to include `DatePicker`. Your existing import will be modified as follows:

```jsx title="src/pages/StartTrip.jsx" showLineNumbers=5
import {
  Button,
  //diff-add-start
  DatePicker,
  //diff-add-end
  ErrorMessage,
  //diff-add-start
  Form,
  FormGroup,
  //diff-add-end
  Grid,
  GridContainer,
  //diff-add-start
  Label,
  //diff-add-end
  StepIndicator,
  StepIndicatorStep,
} from "@trussworks/react-uswds";
```

**Understanding the USWDS Components:**

Before we start building the form, let's understand what each of these imported components does:

- **`Form`**: Main container for form elements with submission handling and styling
- **`FormGroup`**: Wrapper that groups form elements for proper spacing and accessibility
- **`Label`**: Creates accessible form labels with support for required indicators
- **`DatePicker`**: Calendar interface for date selection with formatting and validation

These components work together to create accessible, well-structured forms that follow USWDS design patterns and accessibility guidelines.

### 1.2: Add the DatePicker to the Form

Now locate the `{/* USWDS Form component */}` to add the following code:

```jsx title="src/pages/StartTrip.jsx" showLineNumbers=272
{/* USWDS Form component */}
```

**Add the `FormGroup`, `Label`, and `DatePicker` input within the `Form` component:**

```jsx
<FormGroup>
  <Label
    htmlFor="tripDate"
    hint=" mm/dd/yyyy"
    className="input-date-label"
    requiredMarker
  >
    Date
  </Label>
  <DatePicker
    id="tripDate"
    name="tripDate"
    defaultValue={formData.tripDate}
    onChange={handleDateChange}
    aria-describedby="tripDate-hint"
    required
  />
</FormGroup>
```

The complete **Form** will look like this:

```jsx title="src/pages/StartTrip.jsx" showLineNumbers=272
{/* USWDS Form component */}
// diff-add-start
<Form onSubmit={handleSubmit} large>
  <FormGroup>
    <Label
      htmlFor="tripDate"
      hint=" mm/dd/yyyy"
      className="input-date-label"
      requiredMarker
    >
      Date
    </Label>
    <DatePicker
      id="tripDate"
      name="tripDate"
      defaultValue={formData.tripDate}
      onChange={handleDateChange}
      aria-describedby="tripDate-hint"
      required
    />
  </FormGroup>
</Form>
// diff-add-end
```

#### React State Management Explanation

Let's look at two key aspects of how React manages state with this form:

1. **Initial State with `defaultValue`**:

   ```jsx title="src/pages/StartTrip.jsx" showLineNumbers=289
   defaultValue={formData.tripDate}
   ```

   - The component initializes form data using React's useState hook:

   ```jsx title="src/pages/StartTrip.jsx" showLineNumbers=72
   const [formData, setFormData] = useState({
     tripDate: "",
     weather: "",
     startTime: "",
   });
   ```

   - This binds the DatePicker's initial value to the component's state
   - When the form first renders, it displays any existing data if editing a trip, or empty if creating a new trip
   - To learn more about React state management, visit [React's Managing State documentation](https://react.dev/learn/managing-state)

2. **Updating State with `onChange`**:

   ```jsx title="src/pages/StartTrip.jsx" showLineNumbers=290
   onChange = { handleDateChange };
   ```

   - The `onChange` attribute is a required prop for controlled inputs. It is called whenever the input's value changes (on every keystroke or selection). Without this handler, React would revert the input to its original value after each change.
   - When a user selects a date, the `handleDateChange` function is called

   ```jsx title="src/pages/StartTrip.jsx" showLineNumbers=149
   const handleDateChange = (value) => {
     setFormData((prevData) => ({ ...prevData, tripDate: value || "" }));
   };
   ```

   - It preserves other form field values by spreading the previous state
   - To learn more about controlled inputs, visit [Input documentation](https://react.dev/reference/react-dom/components/input#controlling-an-input-with-a-state-variable)

## Step 2: Add Time Picker Input

Next, we'll add an input for the trip's start time using the `TimePicker` component.

### 2.1: Import the TimePicker Component

Open `src/pages/StartTrip.jsx` and update the import statement from `@trussworks/react-uswds` to include `TimePicker`. Your existing import will be modified as follows:

```jsx title="src/pages/StartTrip.jsx" showLineNumbers=5
import {
  Button,
  DatePicker,
  ErrorMessage,
  Form,
  FormGroup,
  Grid,
  GridContainer,
  Label,
  StepIndicator,
  StepIndicatorStep,
  //diff-add-start
  TimePicker,
  //diff-add-end
} from "@trussworks/react-uswds";
```

### 2.2: Add the TimePicker to the Form

Let's add the `TimePicker` input below the `DatePicker` form group:

```jsx title="src/pages/StartTrip.jsx" showLineNumbers=315
<FormGroup>
  <Label htmlFor="startTime" className="input-time-label" requiredMarker>
    Time
  </Label>
  <TimePicker
    id="startTime"
    name="startTime"
    defaultValue={formData.startTime}
    onChange={handleTimeChange}
    minTime="00:00"
    maxTime="23:45"
    step={15}
    aria-describedby="startTime-error-message"
  />
</FormGroup>
```

**Explanation:**

- Similar to the `DatePicker`, we use `FormGroup` and `Label` for structure and accessibility
- `defaultValue={formData.startTime}` binds the input to the `startTime` field in our state
- `onChange={handleTimeChange}` calls our specific handler function to update the state
- `minTime`, `maxTime`, and `step={15}` configure the available time options (from 00:00 to 23:45 in 15-minute increments)

## Step 3: Add Weather Select Input

Finally, we need a dropdown menu for the user to select the weather conditions at the start of the trip. We'll use the `Select` component.

### 3.1: Import the Select Component

Open `src/pages/StartTrip.jsx` and update the import statement from `@trussworks/react-uswds` to include `Select`. Your existing import will be modified as follows:

```jsx title="src/pages/StartTrip.jsx" showLineNumbers=5
import {
  Button,
  DatePicker,
  TimePicker,
  ErrorMessage,
  Form,
  FormGroup,
  Grid,
  GridContainer,
  Label,
  //diff-add-start
  Select,
  //diff-add-end
  StepIndicator,
  StepIndicatorStep,
} from "@trussworks/react-uswds";
```

### 3.2: Add the Select to the Form

Add the following code below the `TimePicker` form group:

```jsx title="src/pages/StartTrip.jsx" showLineNumbers=352
<FormGroup>
  <Label htmlFor="weather" requiredMarker>
    Weather
  </Label>
  <Select
    id="weather"
    name="weather"
    value={formData.weather}
    onChange={handleInputChange}
    aria-describedby="weather-error-message"
  >
    <option value="">-Select-</option>
    <option value="Sunny">Sunny</option>
    <option value="Cloudy">Cloudy</option>
    <option value="Rainy">Rainy</option>
  </Select>
</FormGroup>
```

**Explanation:**

- `value={formData.weather}` binds the selected option to the `weather` field in the state.
- `onChange={handleInputChange}` uses the standard input handler (already present) because the `Select` component behaves like a standard HTML select element in this regard.
- We define the available weather options using standard HTML `<option>` tags within the `Select` component. The first option has an empty `value` to represent the default, unselected state.

The complete **Form** will look like this: 

```jsx title="src/pages/StartTrip.jsx" showLineNumbers=272
{/* USWDS Form component */}
  // diff-add-start
<Form onSubmit={handleSubmit} large>
  <FormGroup>
    <Label
      htmlFor="tripDate"
      hint=" mm/dd/yyyy"
      className="input-date-label"
      requiredMarker
    >
      Date
    </Label>
    <DatePicker
      id="tripDate"
      name="tripDate"
      defaultValue={formData.tripDate}
      onChange={handleDateChange}
      aria-describedby="tripDate-hint"
      required
    />
  </FormGroup>
  <FormGroup>
    <Label htmlFor="startTime" className="input-time-label" requiredMarker>
      Time
    </Label>
    <TimePicker
      id="startTime"
      name="startTime"
      defaultValue={formData.startTime}
      onChange={handleTimeChange}
      minTime="00:00"
      maxTime="23:45"
      step={15}
      aria-describedby="startTime-error-message"
    />
  </FormGroup>
  <FormGroup>
    <Label htmlFor="weather" requiredMarker>
      Weather
    </Label>
    <Select
      id="weather"
      name="weather"
      value={formData.weather}
      onChange={handleInputChange}
      aria-describedby="weather-error-message"
    >
      <option value="">-Select-</option>
      <option value="Sunny">Sunny</option>
      <option value="Cloudy">Cloudy</option>
      <option value="Rainy">Rainy</option>
    </Select>
  </FormGroup>
</Form>
// diff-add-end
```

## Conclusion

You have now successfully implemented the user interface for the first step of the trip logging form! You've added USWDS `DatePicker`, `TimePicker`, and `Select` components to capture the trip's start date, time, and weather. These inputs are connected to the component's state, ready to be saved. The development server is running with HMR, making it easy to see your changes as you make them.

In the next lesson, we will implement the logic to save the data entered in this form using RADFish's offline storage capabilities (IndexedDB) and navigate the user to the next step.
